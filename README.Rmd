---
title: "Colouring Queen Graphs"
author: "Matthew Henderson"
date: "14/09/2022"
output:
  github_document:
    toc: yes
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  collapse = TRUE,
  comment = "#>",
  fig.path = "figure/",
  message = FALSE)
```

# Colouring Queen Graphs in R with ccli

```{r queen_colouring}
library(dplyr)
library(ggplot2)
library(here)
library(igraph)
library(readr)
library(stringr)

source(here("R", "ccli_greedy.R"))

queen_path <- here("graphs", "queen5_5.col")

queen5 <- read_graph(queen_path, format = "dimacs")

coloured_queen <- set_vertex_attr(queen5, "color", value = greedy(queen_path))

plot(queen5,
     vertex.size = 8,
     vertex.size2 = 8,
     vertex.label = NA,
     vertex.color = vertex_attr(coloured_queen, "color"),
     edge.arrow.mode = 0,
     layout = layout_on_grid)
```

# Minimal Number of Colours in a Greedy Colouring of a Queen Graph

```{r results_plot, echo = FALSE, fig.height=8}
results <- read_rds(here("data", "results.rds"))

results <- results %>%
  mutate(
    method = paste(type, ordering, sep = "+")
  )

results %>%
  ggplot(aes(n, n_colours, colour = method)) +
    geom_jitter(size = 1, alpha = .03, height = 0) +
    geom_abline(colour = "blue", alpha = .2, slope = 1, intercept = 0) +
    ylim(0, 30) +
    xlim(0, 30) +
    theme_minimal() +
    theme(legend.position = "none")
```


```{r other_results_plot, echo=FALSE, fig.height=8}
results %>%
  group_by(n) %>%
  slice_min(n_colours) %>%
    ggplot(aes(n, n_colours, colour = method)) +
    geom_jitter(size = 1, alpha = .3, height = 0) +
    geom_abline(colour = "blue", alpha = .2, slope = 1, intercept = 0) +
    ylim(0, 30) +
    xlim(0, 30) +
    theme_minimal()
```
